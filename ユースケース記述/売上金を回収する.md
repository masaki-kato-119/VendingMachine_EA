# ユースケース: 売上金を回収する

## 概要
管理者が自動販売機から売上金（硬貨・紙幣等）を安全かつ適切に回収し、売上金管理の記録を行う一連の流れ。

## アクター
- 管理者

## 事前条件
- 管理者が自動販売機の解錠権限を持っていること
- 自動販売機が回収作業可能な状態にあること（メンテナンスモード等）

## 事後条件
- 売上金が適切に回収・封入され、売上履歴・回収履歴が更新される

## 基本フロー

| フローID | 内容 |
|:---:|:-----|
| BF-1 | 管理者は自動販売機の施錠を解除し、回収用ドアを開く。 |
| BF-2 | システム（機械内部）は売上金（現金収納箱・釣銭ボックス等）へのアクセスを許可する。 |
| BF-3 | 管理者は売上金（硬貨・紙幣）収納箱を取り外し、売上金を回収する。 |
| BF-4 | 必要に応じて釣銭ボックスに釣銭を補充、または点検する。 |
| BF-5 | 管理者は収納箱をもとの位置に戻し、ドアを閉じて施錠する。 |
| BF-6 | システムまたは管理者は回収日時・回収担当などの回収履歴を記録する（自動記録、または紙の記録）。 |

### 分岐
- 【BF-2】【BF-3】でエラーや不具合（収納箱が外れない、現金詰まり等）が発生した場合→例外フロー【EF-1】へ
- 【BF-6】で記録機能が正しく作動しない場合→例外フロー【EF-2】へ

## 例外フロー

| フローID | 内容 |
|:---:|:-----|
| EF-1-1 | 機械内部故障、収納箱が詰まっている等で売上金が取り出せない場合、システムは警告を表示しメンテナンス担当への対応を促す。 |
| EF-1-2 | 管理者は現地での対処、または別途メンテナンス依頼を行い、処理終了。 |

| フローID | 内容 |
|:---:|:-----|
| EF-2-1 | 回収履歴の記録ができなかった場合、管理者は紙で記録する、管理者に報告する等別手続きをとる。 |
| EF-2-2 | 処理終了。 |

## 備考
- 売上金回収時には回収袋等への封入や、作業記録票への記入などの現場運用が伴う場合がある。
- 最新機種では回収時に自動で現金残高や回収時刻が端末・コネクタ等に記録されることも多い。
- 防犯上、回収操作時は必ず施錠・解錠管理や警報システム連動が行われている場合がある。
- 管理者が釣銭補充・商品補充を同時に行う場合もあるが、本ユースケースでは現金回収にフォーカスしている。

