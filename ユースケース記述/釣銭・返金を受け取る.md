 ユースケース: 釣銭・返金を受け取る

## 概要
利用者が自動販売機の釣銭レバー（返金レバー）を操作し、釣銭または投入金額の返金を受け取るまでの流れ。

## アクター
- 利用者

## 事前条件
- 自動販売機に投入済みの金額があること
- 商品を購入し終え釣銭が発生している、または商品未選択でキャンセル（返金）希望の状態であること

## 事後条件
- 利用者が釣銭または返金金額を受け取る
- システム（自動販売機）は釣銭・返金処理を完了状態とする

## 基本フロー

| フローID | 内容 |
|:---:|:-----|
| BF-1 | 利用者は釣銭レバー（返金レバー）を操作する。 |
| BF-2 | システムは釣銭または投入する金額分の返金を釣銭・返金取り出し口に払い出す。 |
| BF-3 | システムは釣銭・返金ランプ点灯やブザー音等で「お釣り（返金）をお取りください」と案内する。 |
| BF-4 | 利用者は釣銭または返金金額を取り出し口から受け取る。 |

### 分岐
- 【BF-2】釣銭詰まりや釣銭切れ等で正常に払い出せない場合、例外フロー【EF-1】へ。
- 【BF-4】で一定時間受け取りがなかった場合、代替フロー【AF-1】へ。

## 代替フロー

| フローID | 内容 |
|:---:|:-----|
| AF-1-1 | 一定時間釣銭や返金未受領の場合、システムは再度音声やランプで受け取りを促す。 |
| AF-1-2 | さらに一定時間経過後、釣銭・返金金額を内部保管へ移し、管理記録として残す。 |
| AF-1-3 | フロー終了。 |

## 例外フロー

| フローID | 内容 |
|:---:|:-----|
| EF-1-1 | 釣銭・返金の払い出しに障害（釣銭切れ、詰まり等）が発生した場合、システムはエラーメッセージや警告ランプ等で通知する。 |
| EF-1-2 | 利用者への返金不能・トラブル内容をディスプレイ等で案内し、必要に応じて管理会社への連絡先も表示する。 |
| EF-1-3 | 利用者は連絡先への問い合わせ等を行う。 |

## 備考
- 釣銭レバーは現金投入後のキャンセルや購入可能商品が選択されなかった場合にも返金操作として利用可能。
- 古い形式の自動販売機では釣銭レバー操作で投入分全額返却される。
- 一部の自動販売機ではタッチパネルやボタン式の返金操作もあるため、必要に応じて名称や操作内容は調整可。
- 釣銭レバー操作を複数回行った場合や物理的不具合時の動作は設計により異なる。

